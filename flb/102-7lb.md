## 七层负载均衡

### 创建 7LB Pipy

在 “Pipy 管理” 添加 `API` 类型的 Pipy `7lb-1`，隶属于组织 `org1`。

- Type ：API
- Template：`default`
- Log：选择上面创建的 `log`
- HTTP 端口：`8080`
- HTTPS 端口：`8443`

### 创建提供者

在 “Open API” 的 “Providers” 中添加名为 `hi` 的提供者。

- Display Name 使用 `Hi`
- Targets 中添加 Host 类型的 target：`192.168.1.14:8081` 和 `192.168.1.14:8082`

### 创建 API

在 “Open API” 的 “API Manage” 中添加 API `api-1`

- Project 选在 `projet-1`
- Pipy 选择上面创建的 `7lb-1`
- Endpoints 中添加 `HTTP` 协议的端点，path 使用 `/hi`
- 添加 Providers
  - Name 使用 `Hi`
  - Type 选择 `Upstream`
  - Protocol 选择 `HTTP`
  - Service Provider 中选择上面添加的 `hi`
  - Path 使用 `/`

### 审查 API

在 “Open API” 的 “API Manage” 中选择上面创建的 API `api-1`，点击 “Review” 按钮，填入 comment 之后点击 “Submit” 按钮。

### 发布 API

在 “Open API” 的 “API Manage” 中选择上面创建的 API `api-1`，点击 “Deploy” 按钮，填入 comment 之后点击 “Submit” 按钮。

### 运行 Pipy 示例

```shell
pipy http://192.168.1.12:30060/repo/flomesh/pipy/7lb-1/
```

### 测试

在运行 Pipy 示例的主机上测试：

```shell
curl localhost:8080
Hi, Pipy
curl localhost:8080
Hi, World
```
